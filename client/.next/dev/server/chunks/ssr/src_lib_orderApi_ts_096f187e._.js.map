{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/victo/OneDrive/Desktop/Tesis/client/src/lib/orderApi.ts"],"sourcesContent":["const API_BASE_URL =\n  process.env.NEXT_PUBLIC_API_URL || \"http://localhost:8000/api\";\n\nexport interface OrderItem {\n  productId: string;\n  name: string;\n  price: number;\n  quantity: number;\n  image?: string;\n}\n\nexport interface ShippingAddress {\n  street: string;\n  city: string;\n  country: string;\n  postalCode: string;\n}\n\nexport interface Order {\n  _id: string;\n  userId: string;\n  items: OrderItem[];\n  total: number;\n  status: \"pendiente\" | \"pagado\" | \"completado\" | \"cancelado\";\n  shippingAddress: ShippingAddress;\n  paymentIntentId?: string;\n  stripeSessionId?: string;\n  paidAt?: string;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport interface CreateOrderResponse {\n  success: boolean;\n  order: Order;\n  message?: string;\n}\n\nexport interface CartItem {\n  _id: string;\n  name: string;\n  price: number;\n  quantity: number;\n  image?: string;\n}\n\n// Create order from cart\nexport const createOrderFromCart = async (\n  token: string,\n  cartItems: CartItem[],\n  shippingAddress: ShippingAddress\n): Promise<CreateOrderResponse> => {\n  try {\n    const payload = {\n      items: cartItems,\n      shippingAddress,\n    };\n    console.log(\"Creating order with payload:\", JSON.stringify(payload, null, 2));\n\n    const response = await fetch(`${API_BASE_URL}/orders`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`,\n      },\n      body: JSON.stringify(payload),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json();\n      console.error(\"Server returned error:\", JSON.stringify(errorData, null, 2));\n      throw new Error(errorData.message || \"Error al crear el pedido\");\n    }\n\n    const orderData = await response.json();\n    console.log(\"Order created successfully:\", orderData);\n\n    return {\n      success: true,\n      order: orderData.order || orderData,\n    };\n  } catch (error) {\n    console.error(\"Error creating order:\", error);\n    return {\n      success: false,\n      order: {} as Order,\n      message:\n        error instanceof Error ? error.message : \"Error al crear el pedido\",\n    };\n  }\n};\n\n// Get user orders\nexport const getUserOrders = async (token: string): Promise<Order[]> => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/orders`, {\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(\"Error al obtener los pedidos\");\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error(\"Error fetching orders:\", error);\n    return [];\n  }\n};\n\n// Get order by ID\nexport const getOrderById = async (\n  orderId: string,\n  token: string\n): Promise<Order | null> => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/orders/${orderId}`, {\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(\"Error al obtener el pedido\");\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error(\"Error fetching order:\", error);\n    return null;\n  }\n};\n\n// Delete order\nexport const deleteOrder = async (\n  orderId: string,\n  token: string\n): Promise<{ success: boolean; message?: string }> => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/orders/${orderId}`, {\n      method: \"DELETE\",\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json();\n      throw new Error(errorData.message || \"Error al eliminar el pedido\");\n    }\n\n    return {\n      success: true,\n      message: \"Pedido eliminado correctamente\",\n    };\n  } catch (error) {\n    console.error(\"Error deleting order:\", error);\n    return {\n      success: false,\n      message:\n        error instanceof Error ? error.message : \"Error al eliminar el pedido\",\n    };\n  }\n};\n\n// Update order status\nexport const updateOrderStatus = async (\n  orderId: string,\n  status: \"pendiente\" | \"pagado\" | \"completado\" | \"cancelado\",\n  token: string,\n  paymentIntentId?: string,\n  stripeSessionId?: string\n): Promise<{ success: boolean; order?: Order; message?: string }> => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/orders/${orderId}/status`, {\n      method: \"PUT\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: `Bearer ${token}`,\n      },\n      body: JSON.stringify({\n        status,\n        paymentIntentId,\n        stripeSessionId,\n      }),\n    });\n\n    if (!response.ok) {\n      const errorData = await response.json();\n      throw new Error(errorData.message || \"Error al actualizar estado del pedido\");\n    }\n\n    const data = await response.json();\n    return {\n      success: true,\n      order: data.order,\n      message: data.message,\n    };\n  } catch (error) {\n    console.error(\"Error updating order status:\", error);\n    return {\n      success: false,\n      message:\n        error instanceof Error\n          ? error.message\n          : \"Error al actualizar estado del pedido\",\n    };\n  }\n};\n"],"names":[],"mappings":"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"}}]
}